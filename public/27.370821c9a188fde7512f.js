(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"0st6":function(e,t,o){"use strict";o.r(t),o.d(t,"UserProfileModule",function(){return J});var r=o("ofXK"),n=o("tyNb"),s=o("3Pt+"),a=o("XNiG"),i=o("1G5W"),c=o("PSD3"),l=o.n(c),d=o("ZLyn"),b=o("AytR"),m=o("fXoL"),u=o("IT5Z"),p=o("o1z6"),f=o("R3Qk");function g(e,t){if(1&e&&(m.Pb(0,"th",21),m.mc(1),m.Ob()),2&e){const e=t.$implicit;m.zb(1),m.oc(" ",e," ")}}function P(e,t){if(1&e&&(m.Pb(0,"tr"),m.Pb(1,"td"),m.mc(2),m.Ob(),m.Pb(3,"td"),m.mc(4),m.Ob(),m.Pb(5,"td"),m.mc(6),m.Zb(7,"date"),m.Ob(),m.Pb(8,"td"),m.mc(9),m.Ob(),m.Pb(10,"td"),m.mc(11),m.Ob(),m.Pb(12,"td"),m.mc(13),m.Ob(),m.Pb(14,"td"),m.mc(15),m.Ob(),m.Pb(16,"td"),m.mc(17),m.Ob(),m.Pb(18,"td"),m.mc(19),m.Ob(),m.Pb(20,"td"),m.mc(21),m.Ob(),m.Ob()),2&e){const e=t.$implicit,o=m.Yb(2).$implicit,r=m.Yb();m.zb(2),m.nc(e.description),m.zb(2),m.nc(e.wayToPay),m.zb(2),m.nc(m.bc(7,10,e.datetime,"dd/MM/yyyy")),m.zb(3),m.oc("#",e.receipt,""),m.zb(2),m.nc(e.coin),m.zb(2),m.oc(" ",r.setFormatAcordingToPaymentMethod(e.amount.toString(),e.coin)," "),m.zb(2),m.nc("true"===e.iva?"Si":"No"),m.zb(2),m.oc(" ",r.setFormatAcordingToPaymentMethod(e.subTotal?e.subTotal.toString():e.amount.toString(),e.coin)," "),m.zb(2),m.oc(" ",r.setCotizacionUsd(e.coin,o.coin,e.cotizacionUsd)," "),m.zb(2),m.oc(" ",r.setDolarCodeFormatAndTotalValue(null==e.totalUsd?null:e.totalUsd.toString(),o.coin,e.cotizacionUsd.toString())," ")}}function h(e,t){if(1&e&&(m.Pb(0,"div",14),m.Pb(1,"div",15),m.Pb(2,"div",16),m.Pb(3,"div",17),m.Pb(4,"div",18),m.Pb(5,"table",19),m.Pb(6,"thead"),m.Pb(7,"tr"),m.kc(8,g,2,1,"th",20),m.Pb(9,"th",21),m.mc(10),m.Ob(),m.Ob(),m.Ob(),m.Pb(11,"tbody"),m.kc(12,P,22,13,"tr",22),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob()),2&e){const e=m.Yb().$implicit,t=m.Yb();m.zb(8),m.dc("ngForOf",t.encabezados),m.zb(2),m.oc(" ","ARS"===e.coin?"Total en ARS":"Total en USD"," "),m.zb(2),m.dc("ngForOf",e.Payments)}}function O(e,t){if(1&e){const e=m.Qb();m.Pb(0,"div",26),m.Wb("click",function(){m.gc(e);const o=t.$implicit;return m.Yb(3).descargarCashFlow(o.cashflow)}),m.Lb(1,"img",27),m.Pb(2,"p"),m.mc(3),m.Zb(4,"slice"),m.Ob(),m.Ob()}if(2&e){const e=t.$implicit,o=m.Yb(3);m.zb(1),m.dc("src",o.setFileToDownloadIcon(e.cashflow),m.hc),m.zb(2),m.nc(m.cc(4,2,e.cashflow,0,e.cashflow.lastIndexOf("_")))}}function v(e,t){if(1&e&&(m.Nb(0),m.Pb(1,"h6",23),m.mc(2),m.Ob(),m.Pb(3,"div",24),m.kc(4,O,5,6,"div",25),m.Ob(),m.Mb()),2&e){const e=m.Yb().$implicit;m.zb(2),m.oc("Archivos para descargar: ",e.title,""),m.zb(2),m.dc("ngForOf",e.Cashflows)}}function w(e,t){if(1&e&&(m.Pb(0,"div"),m.Lb(1,"img",33),m.Ob()),2&e){const e=m.Yb().$implicit;m.zb(1),m.dc("src",e.base64,m.hc)}}function y(e,t){if(1&e&&(m.Pb(0,"div",34),m.Lb(1,"video",35),m.Ob()),2&e){const e=m.Yb().$implicit;m.zb(1),m.dc("src",e.base64,m.hc)("autoplay",!1)("muted",!0)("loop",!0)("controls",!0)}}function _(e,t){if(1&e&&(m.Pb(0,"div"),m.Pb(1,"div",31),m.kc(2,w,2,1,"div",12),m.kc(3,y,2,5,"div",32),m.Ob(),m.Ob()),2&e){const e=t.$implicit,o=m.Yb(2).$implicit,r=m.Yb();m.Bb(r.showGalleryCard(e,o)?"display-block":"display-none"),m.zb(2),m.dc("ngIf",r.showGalleryImage(e,o)),m.zb(1),m.dc("ngIf",r.showGalleryVideo(e,o))}}function z(e,t){if(1&e&&(m.Pb(0,"div",28),m.Pb(1,"h6",23),m.mc(2),m.Ob(),m.Lb(3,"hr"),m.Pb(4,"div",29),m.kc(5,_,4,4,"div",30),m.Ob(),m.Ob()),2&e){const e=m.Yb().$implicit,t=m.Yb();m.zb(2),m.oc("Galer\xeda: ",e.title,""),m.zb(3),m.dc("ngForOf",t.assets)}}function F(e,t){if(1&e&&(m.Pb(0,"div",2),m.Pb(1,"h4",3),m.mc(2),m.Pb(3,"span",4),m.mc(4),m.Ob(),m.Ob(),m.Pb(5,"div",5),m.Lb(6,"div",6),m.Ob(),m.Pb(7,"span",7),m.mc(8),m.Ob(),m.Pb(9,"h5",8),m.mc(10," Total "),m.Pb(11,"span",9),m.mc(12),m.Zb(13,"currency"),m.Ob(),m.Ob(),m.Pb(14,"h5",10),m.mc(15," Balance: "),m.Lb(16,"br"),m.Pb(17,"span"),m.mc(18),m.Lb(19,"i"),m.Ob(),m.Pb(20,"span",4),m.mc(21),m.Zb(22,"currency"),m.Ob(),m.Ob(),m.kc(23,h,13,3,"div",11),m.kc(24,v,5,2,"ng-container",12),m.kc(25,z,6,2,"div",13),m.Ob()),2&e){const e=t.$implicit,o=t.index,r=m.Yb();m.zb(2),m.oc(" ",e.title?e.title:"Proyecto sin t\xedtulo"," "),m.zb(2),m.oc("",r.porcentaje[o],"%"),m.zb(2),m.jc(r.progressBarStyle[o]),m.zb(2),m.oc("Moneda del proyecto: ",e.coin,""),m.zb(4),m.nc(m.ac(13,15,e.total)),m.zb(2),m.Bb(e.balance?"text-warning":"text-success"),m.zb(4),m.oc(" ",e.balance?"Falta pagar":"\xa1Estas al d\xeda!"," "),m.zb(1),m.Bb(e.balance?"":"ti ti-face-smile"),m.zb(2),m.nc(m.ac(22,17,e.balance)),m.zb(2),m.dc("ngIf",null==e.Payments?null:e.Payments.length),m.zb(1),m.dc("ngIf",null==e.Cashflows?null:e.Cashflows.length),m.zb(1),m.dc("ngIf",e.Assets.length)}}let C=(()=>{class e{constructor(e,t){this.projectsService=e,this.currencyPipe=t,this.onDownloadCashflow=new m.n,this.encabezados=["Descripci\xf3n","Detalle de pago","Fecha","Factura","Moneda del pago","Subtotal","IVA","Total","Cotizaci\xf3n USD"],this.proyectos=[],this.assets=[],this.destroy$=new a.a}set setProyectos(e){e&&e.projects&&(this.proyectos=e.projects)}ngOnInit(){this.setAssets()}get progressBarStyle(){var e;const t=[];return null===(e=this.proyectos)||void 0===e||e.forEach(e=>{const o=this.setPorcentaje(e.total,e.balance);t.push(`width: ${o}%`)}),t}get porcentaje(){var e;const t=[];return null===(e=this.proyectos)||void 0===e||e.forEach(e=>{const o=this.setPorcentaje(e.total,e.balance);t.push(o)}),t}setDolarCodeFormatAndTotalValue(e,t,o){return"ARS"===t?(e=(+e*+o).toString(),e=(e=this.currencyPipe.transform(e,"ARS","code")).substring(0,3)+" "+e.substring(3,e.length)):e=(e=this.currencyPipe.transform(e,"USD","code")).substring(0,3)+" "+e.substring(3,e.length),e}setCotizacionUsd(e,t,o){return"ARS"===e&&"ARS"===t||"USD"===e&&"USD"===t?"-":o}setFormatAcordingToPaymentMethod(e,t){return(e="USD"===t?this.currencyPipe.transform(e,"USD","code"):this.currencyPipe.transform(e)).includes("USD")&&(e=e.substring(0,3)+" "+e.substring(3,e.length)),e}setPorcentaje(e,t){let o=e-t;return o=100*o/e,Math.round(o)}descargarCashFlow(e){this.onDownloadCashflow.emit(e)}setFileToDownloadIcon(e){return e.includes(".pdf")?"../../../../../assets/pdficon.png":e.includes(".xls")||e.includes(".xlsx")?"../../../../../assets/excelicon.png":e.includes(".doc")||e.includes(".docx")?"../../../../../assets/word.png":e.includes(".png")||e.includes(".jpg")||e.includes(".jpeg")?"../../../../../assets/mediafile.png":""}setAssets(){var e;null===(e=this.proyectos)||void 0===e||e.forEach(e=>{e.Assets.forEach(t=>{this.projectsService.getAssetsDeUnProyecto(t.asset).pipe(Object(i.a)(this.destroy$)).subscribe({next:o=>{const r=new FileReader;r.readAsDataURL(o),r.onload=()=>{this.assets.push({base64:r.result,project_id:e.id,type:o.type,asset_id:t.id})}},error:e=>Object(d.e)(e)})})})}showGalleryCard(e,t){return e.project_id===t.id}showGalleryImage(e,t){return e.type.includes("image")&&e.project_id===t.id}showGalleryVideo(e,t){return e.type.includes("video")&&e.project_id===t.id}expandImage(e){l.a.fire({imageUrl:e,imageWidth:400,imageHeight:400,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp"}})}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(p.a),m.Kb(r.d))},e.\u0275cmp=m.Eb({type:e,selectors:[["app-proyects"]],inputs:{setProyectos:"setProyectos"},outputs:{onDownloadCashflow:"onDownloadCashflow"},features:[m.yb([r.d])],decls:4,vars:1,consts:[[1,"font-medium","m-t-30"],["class","mb-5 project",4,"ngFor","ngForOf"],[1,"mb-5","project"],[1,"m-t-30","primary-dark"],[1,"pull-right"],[1,"progress"],["role","progressbar","aria-valuenow","80","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","bgc-primary-dark"],[1,"m-t-30"],[1,"m-t-10","primary-dark"],[1,"pull-right","primary-dark"],[1,"m-t-10"],["class","row animated fadeIn rows-container",4,"ngIf"],[4,"ngIf"],["class","row proyect-carrousel mt-5 b-b-5",4,"ngIf"],[1,"row","animated","fadeIn","rows-container"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-bordered"],["class","text-nowrap primary-dark",4,"ngFor","ngForOf"],[1,"text-nowrap","primary-dark"],[4,"ngFor","ngForOf"],[1,"primary-dark","mt-3"],[1,"cashflows-container","mt-3"],["class","cashflows-container__card pointer",3,"click",4,"ngFor","ngForOf"],[1,"cashflows-container__card","pointer",3,"click"],["alt","Icono",3,"src"],[1,"row","proyect-carrousel","mt-5","b-b-5"],[1,"gallery"],[3,"class",4,"ngFor","ngForOf"],[1,"gallery__card"],["class","embed-responsive embed-responsive-21by9",4,"ngIf"],["alt","Construcci\xf3n",1,"",3,"src"],[1,"embed-responsive","embed-responsive-21by9"],[1,"embed-responsive-item",3,"src","autoplay","muted","loop","controls"]],template:function(e,t){1&e&&(m.Pb(0,"h4",0),m.mc(1,"Proyectos:"),m.Ob(),m.Lb(2,"hr"),m.kc(3,F,26,19,"div",1)),2&e&&(m.zb(3),m.dc("ngForOf",t.proyectos))},directives:[r.l,r.m],pipes:[r.d,r.f,r.p],styles:[".project[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{height:6px}.project[_ngcontent-%COMP%]   .cashflows-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;row-gap:10px}@media (max-width:1343px){.project[_ngcontent-%COMP%]   .cashflows-container[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}@media (max-width:990px){.project[_ngcontent-%COMP%]   .cashflows-container[_ngcontent-%COMP%]{grid-template-columns:1fr}}.project[_ngcontent-%COMP%]   .cashflows-container__card[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.project[_ngcontent-%COMP%]   .cashflows-container__card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:50px}.project[_ngcontent-%COMP%]   .gallery[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;row-gap:10px;column-gap:10px}@media (max-width:1165px){.project[_ngcontent-%COMP%]   .gallery[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr}}@media (max-width:525px){.project[_ngcontent-%COMP%]   .gallery[_ngcontent-%COMP%]{grid-template-columns:1fr}}.project[_ngcontent-%COMP%]   .gallery__card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:250px}.project[_ngcontent-%COMP%]   .gallery__card[_ngcontent-%COMP%]   .embed-responsive[_ngcontent-%COMP%], .project[_ngcontent-%COMP%]   .gallery__card[_ngcontent-%COMP%]   .embed-responsive-21by9[_ngcontent-%COMP%]{height:250px;background-color:#000}.project[_ngcontent-%COMP%]   .gallery__card[_ngcontent-%COMP%]   .embed-responsive-21by9[_ngcontent-%COMP%]   video[_ngcontent-%COMP%], .project[_ngcontent-%COMP%]   .gallery__card[_ngcontent-%COMP%]   .embed-responsive[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:250px}.project[_ngcontent-%COMP%]   .gallery[_ngcontent-%COMP%]   .display-none[_ngcontent-%COMP%]{display:none}.project[_ngcontent-%COMP%]   .gallery[_ngcontent-%COMP%]   .display-block[_ngcontent-%COMP%]{display:block}"]}),e})();function k(e,t){1&e&&(m.Pb(0,"div",33),m.Pb(1,"span",47),m.mc(2,"Formato de im\xe1gen inv\xe1lido"),m.Ob(),m.Ob())}function M(e,t){1&e&&(m.Pb(0,"li",48),m.Pb(1,"a",49),m.mc(2,"Administrar p\xe1gina"),m.Ob(),m.Ob())}function I(e,t){if(1&e){const e=m.Qb();m.Nb(0),m.Pb(1,"app-proyects",50),m.Wb("onDownloadCashflow",function(t){return m.gc(e),m.Yb().descargarCashflow(t)}),m.Ob(),m.Mb()}if(2&e){const e=m.Yb();m.zb(1),m.dc("setProyectos",e.user)}}function x(e,t){1&e&&(m.Pb(0,"h4",51),m.mc(1,"Proyectos:"),m.Ob(),m.Lb(2,"hr"),m.Pb(3,"h5",52),m.mc(4," Todav\xeda no tenes un proyecto asignado "),m.Pb(5,"span"),m.mc(6,"\xa1No te quedes esperando y escribinos!"),m.Ob(),m.Ob())}function j(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Este dato es requerido"),m.Ob())}function S(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Debe tener al menos 3 caracteres"),m.Ob())}function E(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Este dato es requerido"),m.Ob())}function L(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Debe tener al menos 3 caracteres"),m.Ob())}function D(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Este dato es requerido"),m.Ob())}function A(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Debe contenter al menos 7 caracteres"),m.Ob())}function R(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"N\xfamero m\xe1ximo 999.999.999"),m.Ob())}function U(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Este dato es requerido"),m.Ob())}function T(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Por favor ingres\xe1 un email v\xe1lido"),m.Ob())}function N(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"La contrase\xf1a debe tener un m\xednimo de 8 caracteres, incluyendo una min\xfascula, una may\xfascula, un n\xfamero y un s\xedmbolo"),m.Ob())}function $(e,t){1&e&&(m.Pb(0,"li"),m.mc(1," La contrase\xf1a debe tener al menos 8 caracteres "),m.Ob())}function W(e,t){1&e&&(m.Pb(0,"li"),m.mc(1," La contrase\xf1a debe contener al menos un n\xfamero "),m.Ob())}function Y(e,t){1&e&&(m.Pb(0,"li"),m.mc(1," La contrase\xf1a debe contener al menos una letra min\xfascula "),m.Ob())}function q(e,t){1&e&&(m.Pb(0,"li"),m.mc(1," La contrase\xf1a debe tener al menos una letra may\xfascula "),m.Ob())}function B(e,t){1&e&&(m.Pb(0,"li"),m.mc(1," La contrase\xf1a debe tener al menos alguno de los siguientes s\xedmbolos *._%+- "),m.Ob())}function G(e,t){if(1&e&&(m.Pb(0,"div",33),m.Pb(1,"ul",53),m.kc(2,$,2,0,"li",54),m.kc(3,W,2,0,"li",54),m.kc(4,Y,2,0,"li",54),m.kc(5,q,2,0,"li",54),m.kc(6,B,2,0,"li",54),m.Ob(),m.Ob()),2&e){const e=m.Yb();m.zb(2),m.dc("ngIf",e.showStrongPasswordErrorMsgs()),m.zb(1),m.dc("ngIf",e.showStrongPasswordErrorMsgs()),m.zb(1),m.dc("ngIf",e.showStrongPasswordErrorMsgs()),m.zb(1),m.dc("ngIf",e.showStrongPasswordErrorMsgs()),m.zb(1),m.dc("ngIf",e.showStrongPasswordErrorMsgs())}}function K(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Este dato es requerido"),m.Ob())}function V(e,t){1&e&&(m.Pb(0,"span",47),m.mc(1,"Las contrase\xf1as no coinciden"),m.Ob())}function Z(e,t){if(1&e){const e=m.Qb();m.Pb(0,"div",55),m.Pb(1,"div",31),m.Pb(2,"div",39),m.Lb(3,"input",56,57),m.Pb(5,"div",42),m.Pb(6,"i",43),m.Wb("click",function(){m.gc(e);const t=m.fc(4);return m.Yb().showRepeatPassword(t)}),m.Ob(),m.Ob(),m.Ob(),m.Pb(7,"div",33),m.kc(8,K,2,0,"span",34),m.kc(9,V,2,0,"span",34),m.Ob(),m.Ob(),m.Ob()}if(2&e){const e=m.Yb();m.zb(6),m.Bb(e.repeatPasswordEye),m.zb(2),m.dc("ngIf",(null==e.editProfileForm.controls.passwordRepeat.errors?null:e.editProfileForm.controls.passwordRepeat.errors.required)&&e.editProfileForm.controls.passwordRepeat.touched),m.zb(1),m.dc("ngIf",(null==e.editProfileForm.controls.passwordRepeat.errors?null:e.editProfileForm.controls.passwordRepeat.errors.notMatch)&&e.editProfileForm.controls.passwordRepeat.touched)}}const Q=[{path:"",component:(()=>{class e{constructor(e,t,o,r,n){this.authService=e,this.fb=t,this.projectsService=o,this.renderer=r,this.userStore=n,this.emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$",this.destroy$=new a.a,this.mostrarRepetirContrasena=!1,this.formatoImagenNoAceptado=!1,this.passwordEye="fa fa-eye-slash",this.userWantsToSeePassword=!1,this.repeatPasswordEye="fa fa-eye-slash",this.userWantsToSeeRepeatPassword=!1,this.setUserAndCreateForm()}setUserAndCreateForm(){this.userStore.loggedUser$.pipe(Object(i.a)(this.destroy$)).subscribe(e=>{e.id?(this.user=e,this.userAvatar=`${b.a.API_IMAGE_URL}/users/${e.avatar}`,this.userName=e.nombre,this.userLastName=e.apellido,this.userEmail=e.email,this.userPhone=e.phone,this.userProjects=e.projects,this.createForm()):this.createForm()})}createForm(){var e,t,o,r,n;this.editProfileForm=this.fb.group({first_name:[null===(e=this.user)||void 0===e?void 0:e.nombre,[s.m.required,s.m.minLength(3)]],last_name:[null===(t=this.user)||void 0===t?void 0:t.apellido,[s.m.required,s.m.minLength(3)]],dni:[null===(o=this.user)||void 0===o?void 0:o.dni,[s.m.required,s.m.max(999999999),s.m.min(1e6)]],email:[null===(r=this.user)||void 0===r?void 0:r.email,[s.m.required,s.m.pattern(this.emailPattern)]],phone:[null===(n=this.user)||void 0===n?void 0:n.phone],password:[""],passwordRepeat:["",[s.m.required]]},{validator:[this.passwordMatchFormValidator,this.validateStrongPassword]})}passwordMatchFormValidator(e){const t=e.get("password"),o=e.get("passwordRepeat");o.setErrors(t.value===o.value?null:{notMatch:!0})}validateStrongPassword(e){const t=e.get("password");(null==t?void 0:t.value)&&(/\d/.test(null==t?void 0:t.value)?/[a-z]/.test(null==t?void 0:t.value)?/[A-Z]/.test(null==t?void 0:t.value)?/[*._%+-]/.test(null==t?void 0:t.value)?(null==t?void 0:t.value.length)<8&&(null==t||t.setErrors({minlength:!0})):null==t||t.setErrors({notSymbols:!0}):null==t||t.setErrors({noUppercase:!0}):null==t||t.setErrors({noLowercase:!0}):null==t||t.setErrors({notDigits:!0}))}showStrongPasswordErrorMsgs(){var e,t,o,r,n;return this.editProfileForm.controls.password.touched&&((null===(e=this.editProfileForm.controls.password.errors)||void 0===e?void 0:e.notDigits)||(null===(t=this.editProfileForm.controls.password.errors)||void 0===t?void 0:t.noLowercase)||(null===(o=this.editProfileForm.controls.password.errors)||void 0===o?void 0:o.noUppercase)||(null===(r=this.editProfileForm.controls.password.errors)||void 0===r?void 0:r.notSymbols)||(null===(n=this.editProfileForm.controls.password.errors)||void 0===n?void 0:n.minlength))}showPassword(e){this.userWantsToSeePassword=!this.userWantsToSeePassword,this.passwordEye=this.userWantsToSeePassword?"fa fa-eye":"fa fa-eye-slash",e.type=this.userWantsToSeePassword?"text":"password"}showRepeatPassword(e){this.userWantsToSeeRepeatPassword=!this.userWantsToSeeRepeatPassword,this.repeatPasswordEye=this.userWantsToSeeRepeatPassword?"fa fa-eye":"fa fa-eye-slash",e.type=this.userWantsToSeeRepeatPassword?"text":"password"}cambiarFoto(e){const t=e.target.files[0],o=new FormData;if(o.append("avatar",t),o.get("avatar"))switch(null==t?void 0:t.type){case"image/jpg":case"image/png":case"image/jpeg":return this.formatoImagenNoAceptado=!1,void this.actualizarImagenEnDB(o);default:this.formatoImagenNoAceptado=!0}}actualizarImagenEnDB(e){this.authService.actualizarImagenUsuario(e).pipe(Object(i.a)(this.destroy$)).subscribe(e=>{e.meta.status.toString().includes("20")?this.modifyLoggedUser(null==e?void 0:e.data):Object(d.e)(e)},e=>Object(d.d)(e))}cambiarPerfil(){this.editProfileForm.markAllAsTouched(),this.editProfileForm.valid&&(this.editProfileForm.controls.password.value?this.confirmAndModifyLoggedUser():this.guardarCambiosEnBaseDeDatos())}guardarCambiosEnBaseDeDatos(){this.authService.actualizarUsuario(this.editProfileForm.value).pipe(Object(i.a)(this.destroy$)).subscribe(e=>{var t;(null===(t=null==e?void 0:e.meta)||void 0===t?void 0:t.status.toString().includes("20"))?this.modifyLoggedUser(null==e?void 0:e.data):Object(d.e)(e)},e=>Object(d.d)(e))}confirmAndModifyLoggedUser(){l.a.fire({title:"\xbfEst\xe1s seguro que quer\xe9s cambiar tu contrase\xf1a?",showDenyButton:!0,confirmButtonText:"Si, continuar",denyButtonText:"No"}).then(e=>{e.isConfirmed&&this.guardarCambiosEnBaseDeDatos()}).catch(e=>Object(d.d)(e))}modifyLoggedUser(e){this.userStore.setUser({id:e.id,nombre:e.first_name,apellido:e.last_name,email:e.email,role:e.role,dni:e.dni,avatar:e.avatar,phone:e.phone,projects:e.Projects}),l.a.fire("\xa1Excelente!","Actualizamos tus datos sin problemas","success")}toggleRepetirConstrasena(){this.mostrarRepetirContrasena=!!this.editProfileForm.controls.password.value}descargarCashflow(e){this.projectsService.getCashflow(e).pipe(Object(i.a)(this.destroy$)).subscribe(t=>{const o=new Blob([t],{type:t.type}),r=window.URL.createObjectURL(o),n=e;let s=this.renderer.createElement("a");s.href=r,s.download=n,s.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(()=>{window.URL.revokeObjectURL(r),s.remove(),this.renderer.destroy()},100)},e=>Object(d.d)(e))}logout(){this.userStore.logout()}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(m.Kb(u.a),m.Kb(s.c),m.Kb(p.a),m.Kb(m.E),m.Kb(f.a))},e.\u0275cmp=m.Eb({type:e,selectors:[["app-user-profile"]],decls:106,vars:30,consts:[[1,"row","animate__animated","animate__fadeIn","animate__slow"],[1,"col-lg-4","col-xlg-3","col-md-5"],[1,"card"],[1,"card-body"],[1,"m-t-30","text-center"],["width","150","height","150",1,"img-circle","pointer",3,"src","click"],["class","p-2",4,"ngIf"],["type","file",1,"d-none",3,"change"],["inputFoto",""],[1,"card-title","m-t-10","primary-dark"],[1,"text-muted"],[1,"text-muted","p-t-30","db",3,"hidden"],[3,"hidden"],[1,"col-lg-8","col-xlg-9","col-md-7"],["role","tablist",1,"nav","nav-tabs","profile-tab"],[1,"nav-item"],["data-toggle","tab","href","#profile","role","tab","aria-expanded","true",1,"nav-link","active"],["data-toggle","tab","href","#settings","role","tab","aria-expanded","false",1,"nav-link"],["class","nav-item bgc-primary",4,"ngIf"],[1,"nav-item","bg-danger","text-white","pointer",3,"click"],["id","admin-pag","aria-expanded","false",1,"nav-link"],[1,"tab-content"],["id","profile","role","tabpanel","aria-expanded","true",1,"tab-pane","active"],[1,"row"],[1,"col-md-4","col-xs-6","b-r"],[1,"col-md-4","col-xs-6"],[4,"ngIf","ngIfElse"],["noProjects",""],["id","settings","role","tabpanel","aria-expanded","false",1,"tab-pane"],[1,"form-horizontal","form-material",3,"formGroup","ngSubmit"],[1,"form-group"],[1,"col-md-12"],["type","text","formControlName","first_name","placeholder","Nombre",1,"form-control","form-control-line","primary-dark"],[1,"p-2"],["class","text-danger",4,"ngIf"],["type","text","formControlName","last_name","placeholder","Apellido",1,"form-control","form-control-line","primary-dark"],["type","text","formControlName","dni","placeholder","DNI",1,"form-control","form-control-line","primary-dark"],["type","email","formControlName","email","placeholder","Email","name","example-email","id","example-email",1,"form-control","form-control-line","primary-dark"],["type","number","placeholder","Tel\xe9fono","formControlName","phone",1,"form-control","form-control-line","primary-dark"],[1,"input-group"],["type","password","placeholder","Escrib\xed tu contrase\xf1a nueva","formControlName","password",1,"form-control","primary-dark",3,"change"],["inputPassword",""],[1,"input-group-addon"],[3,"click"],["class","form-group animate__animated animate__slideInLeft animate__fast",4,"ngIf"],[1,"col-sm-12"],["type","submit",1,"btn","btn-success"],[1,"text-danger"],[1,"nav-item","bgc-primary"],["id","admin-pag","routerLink","/admin","aria-expanded","false",1,"nav-link"],[3,"setProyectos","onDownloadCashflow"],[1,"font-medium","m-t-30"],[1,"m-t-30"],[1,"form-text","text-danger","list-unstyled"],[4,"ngIf"],[1,"form-group","animate__animated","animate__slideInLeft","animate__fast"],["type","password","placeholder","Repet\xed tu contrase\xf1a nueva","formControlName","passwordRepeat",1,"form-control"],["inputRepeatPassword",""]],template:function(e,t){if(1&e){const e=m.Qb();m.Pb(0,"div",0),m.Pb(1,"div",1),m.Pb(2,"div",2),m.Pb(3,"div",3),m.Pb(4,"div",4),m.Pb(5,"img",5),m.Wb("click",function(){return m.gc(e),m.fc(8).click()}),m.Ob(),m.kc(6,k,3,0,"div",6),m.Pb(7,"input",7,8),m.Wb("change",function(e){return t.cambiarFoto(e)}),m.Ob(),m.Pb(9,"h4",9),m.mc(10),m.Ob(),m.Ob(),m.Ob(),m.Pb(11,"div"),m.Lb(12,"hr"),m.Ob(),m.Pb(13,"div",3),m.Pb(14,"h4",10),m.mc(15,"Email"),m.Ob(),m.Pb(16,"h6"),m.mc(17),m.Ob(),m.Pb(18,"h4",11),m.mc(19,"Tel\xe9fono"),m.Ob(),m.Pb(20,"h6",12),m.mc(21),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Pb(22,"div",13),m.Pb(23,"div",2),m.Pb(24,"ul",14),m.Pb(25,"li",15),m.Pb(26,"a",16),m.mc(27,"Yo"),m.Ob(),m.Ob(),m.Pb(28,"li",15),m.Pb(29,"a",17),m.mc(30,"Editar perfil"),m.Ob(),m.Ob(),m.kc(31,M,3,0,"li",18),m.Pb(32,"li",19),m.Wb("click",function(){return t.logout()}),m.Pb(33,"a",20),m.mc(34,"Cerrar sesi\xf3n"),m.Ob(),m.Ob(),m.Ob(),m.Pb(35,"div",21),m.Pb(36,"div",22),m.Pb(37,"div",3),m.Pb(38,"div",23),m.Pb(39,"div",24),m.Pb(40,"strong"),m.mc(41,"Nombre completo"),m.Ob(),m.Lb(42,"br"),m.Pb(43,"p",10),m.mc(44),m.Ob(),m.Ob(),m.Pb(45,"div",24),m.Pb(46,"strong"),m.mc(47,"Tel\xe9fono"),m.Ob(),m.Lb(48,"br"),m.Pb(49,"p",10),m.mc(50),m.Ob(),m.Ob(),m.Pb(51,"div",25),m.Pb(52,"strong"),m.mc(53,"Email"),m.Ob(),m.Lb(54,"br"),m.Pb(55,"p",10),m.mc(56),m.Ob(),m.Ob(),m.Ob(),m.Lb(57,"hr"),m.kc(58,I,2,1,"ng-container",26),m.kc(59,x,7,0,"ng-template",null,27,m.lc),m.Ob(),m.Ob(),m.Pb(61,"div",28),m.Pb(62,"div",3),m.Pb(63,"form",29),m.Wb("ngSubmit",function(){return t.cambiarPerfil()}),m.Pb(64,"div",30),m.Pb(65,"div",31),m.Lb(66,"input",32),m.Pb(67,"div",33),m.kc(68,j,2,0,"span",34),m.kc(69,S,2,0,"span",34),m.Ob(),m.Ob(),m.Ob(),m.Pb(70,"div",30),m.Pb(71,"div",31),m.Lb(72,"input",35),m.Ob(),m.Pb(73,"div",33),m.kc(74,E,2,0,"span",34),m.kc(75,L,2,0,"span",34),m.Ob(),m.Ob(),m.Pb(76,"div",30),m.Pb(77,"div",31),m.Lb(78,"input",36),m.Pb(79,"div",33),m.kc(80,D,2,0,"span",34),m.kc(81,A,2,0,"span",34),m.kc(82,R,2,0,"span",34),m.Ob(),m.Ob(),m.Ob(),m.Pb(83,"div",30),m.Pb(84,"div",31),m.Lb(85,"input",37),m.Pb(86,"div",33),m.kc(87,U,2,0,"span",34),m.kc(88,T,2,0,"span",34),m.Ob(),m.Ob(),m.Ob(),m.Pb(89,"div",30),m.Pb(90,"div",31),m.Lb(91,"input",38),m.Lb(92,"div",33),m.Ob(),m.Ob(),m.Pb(93,"div",30),m.Pb(94,"div",39),m.Pb(95,"input",40,41),m.Wb("change",function(){return t.toggleRepetirConstrasena()}),m.Ob(),m.Pb(97,"div",42),m.Pb(98,"i",43),m.Wb("click",function(){m.gc(e);const o=m.fc(96);return t.showPassword(o)}),m.Ob(),m.Ob(),m.kc(99,N,2,0,"span",34),m.Ob(),m.kc(100,G,7,5,"div",6),m.Ob(),m.kc(101,Z,10,4,"div",44),m.Pb(102,"div",30),m.Pb(103,"div",45),m.Pb(104,"button",46),m.mc(105," Actualizar perfil "),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob(),m.Ob()}if(2&e){const e=m.fc(60);m.zb(5),m.dc("src",t.userAvatar,m.hc),m.zb(1),m.dc("ngIf",t.formatoImagenNoAceptado),m.zb(4),m.pc(" ",t.userName," ",t.userLastName," "),m.zb(7),m.nc(t.userEmail),m.zb(1),m.dc("hidden",!t.userPhone),m.zb(2),m.dc("hidden",!t.userPhone),m.zb(1),m.nc(t.userPhone),m.zb(10),m.dc("ngIf","admin"===(null==t.user?null:t.user.role)||"master"===(null==t.user?null:t.user.role)),m.zb(13),m.pc(" ",t.userName," ",t.userLastName," "),m.zb(6),m.nc(t.userPhone),m.zb(6),m.nc(t.userEmail),m.zb(2),m.dc("ngIf",t.userProjects)("ngIfElse",e),m.zb(5),m.dc("formGroup",t.editProfileForm),m.zb(5),m.dc("ngIf",(null==t.editProfileForm.controls.first_name.errors?null:t.editProfileForm.controls.first_name.errors.required)&&t.editProfileForm.controls.first_name.touched),m.zb(1),m.dc("ngIf",(null==t.editProfileForm.controls.first_name.errors?null:t.editProfileForm.controls.first_name.errors.minlength)&&t.editProfileForm.controls.first_name.touched),m.zb(5),m.dc("ngIf",(null==t.editProfileForm.controls.last_name.errors?null:t.editProfileForm.controls.last_name.errors.required)&&t.editProfileForm.controls.last_name.touched),m.zb(1),m.dc("ngIf",(null==t.editProfileForm.controls.last_name.errors?null:t.editProfileForm.controls.last_name.errors.minlength)&&t.editProfileForm.controls.last_name.touched),m.zb(5),m.dc("ngIf",(null==t.editProfileForm.controls.dni.errors?null:t.editProfileForm.controls.dni.errors.required)&&t.editProfileForm.controls.dni.touched),m.zb(1),m.dc("ngIf",(null==t.editProfileForm.controls.dni.errors?null:t.editProfileForm.controls.dni.errors.min)&&t.editProfileForm.controls.dni.touched),m.zb(1),m.dc("ngIf",(null==t.editProfileForm.controls.dni.errors?null:t.editProfileForm.controls.dni.errors.max)&&t.editProfileForm.controls.dni.touched),m.zb(5),m.dc("ngIf",(null==t.editProfileForm.controls.email.errors?null:t.editProfileForm.controls.email.errors.required)&&t.editProfileForm.controls.email.touched),m.zb(1),m.dc("ngIf",(null==t.editProfileForm.controls.email.errors?null:t.editProfileForm.controls.email.errors.pattern)&&t.editProfileForm.controls.email.touched),m.zb(10),m.Bb(t.passwordEye),m.zb(1),m.dc("ngIf",(null==t.editProfileForm.controls.password.errors?null:t.editProfileForm.controls.password.errors.pattern)&&t.editProfileForm.controls.password.touched),m.zb(1),m.dc("ngIf",t.showStrongPasswordErrorMsgs()),m.zb(1),m.dc("ngIf",t.mostrarRepetirContrasena)}},directives:[r.m,s.n,s.h,s.e,s.b,s.g,s.d,s.j,n.e,C],styles:["#admin-pag[_ngcontent-%COMP%]{color:#fff}"]}),e})()}];let H=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.Ib({type:e}),e.\u0275inj=m.Hb({imports:[[n.f.forChild(Q)],n.f]}),e})(),X=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.Ib({type:e}),e.\u0275inj=m.Hb({imports:[[r.c]]}),e})(),J=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.Ib({type:e}),e.\u0275inj=m.Hb({imports:[[r.c,H,n.f,s.k,X]]}),e})()}}]);