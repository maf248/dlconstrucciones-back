(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{SKfq:function(t,e,a){"use strict";a.r(e),a.d(e,"ZonasModule",function(){return I});var i=a("ofXK"),n=a("tyNb"),o=a("XNiG"),r=a("1G5W"),s=a("PSD3"),c=a.n(s),b=a("3Pt+"),l=a("AytR"),d=a("ZLyn"),u=a("fXoL"),m=a("N+K7"),h=a("T9Ob"),g=a("FQRV");function p(t,e){if(1&t){const t=u.Qb();u.Pb(0,"app-table",6),u.Wb("onRecargar",function(e){return u.gc(t),u.Yb(2).recargarZonas(e)})("onCreate",function(){return u.gc(t),u.Yb(2).openCrearZona()})("onEdit",function(e){return u.gc(t),u.Yb(2).openEditarZona(e)})("onDelete",function(e){return u.gc(t),u.Yb(2).openBorrarZona(e)}),u.Ob()}if(2&t){const t=u.Yb(2);u.dc("title","Zonas")("filasTabla",t.tableData)("encabezadosTabla",t.encabezadosTabla)("totalSection",null==t.tableData?null:t.tableData.length)}}function f(t,e){if(1&t&&(u.Pb(0,"div",2),u.Pb(1,"div",3),u.Pb(2,"div",4),u.kc(3,p,1,4,"app-table",5),u.Ob(),u.Ob(),u.Ob()),2&t){const t=u.Yb();u.zb(3),u.dc("ngIf",t.tableData)}}function v(t,e){if(1&t&&(u.Pb(0,"span",23),u.mc(1),u.Ob()),2&t){const t=u.Yb(2);u.zb(1),u.nc(t.creationImageError)}}function z(t,e){1&t&&(u.Pb(0,"span",23),u.mc(1,"Los formatos aceptados son JPG, JPEG y PNG"),u.Ob())}function O(t,e){1&t&&(u.Pb(0,"span",23),u.mc(1,"Este campo es requerido"),u.Ob())}function P(t,e){1&t&&(u.Pb(0,"span",23),u.mc(1,"Debe tener al menos 6 caracteres"),u.Ob())}function y(t,e){if(1&t){const t=u.Qb();u.Pb(0,"div",2),u.Pb(1,"div",3),u.Pb(2,"div",7),u.Pb(3,"h1",8),u.mc(4),u.Ob(),u.Ob(),u.Pb(5,"div",4),u.Pb(6,"form",9),u.Wb("ngSubmit",function(){return u.gc(t),u.Yb().formSubmit()}),u.Pb(7,"div",4),u.Pb(8,"div",10),u.Pb(9,"div",11),u.Wb("click",function(){return u.gc(t),u.fc(12).click()}),u.Lb(10,"img",12),u.Pb(11,"input",13,14),u.Wb("change",function(e){return u.gc(t),u.Yb().showSelectedImage(e)}),u.Ob(),u.Pb(13,"div",15),u.kc(14,v,2,1,"span",16),u.kc(15,z,2,0,"span",16),u.Ob(),u.Ob(),u.Ob(),u.Pb(16,"div",0),u.Pb(17,"div",2),u.Pb(18,"div",17),u.Pb(19,"div",18),u.Lb(20,"input",19),u.Pb(21,"div",15),u.kc(22,O,2,0,"span",16),u.kc(23,P,2,0,"span",16),u.Ob(),u.Ob(),u.Ob(),u.Ob(),u.Ob(),u.Ob(),u.Pb(24,"div",20),u.Pb(25,"button",21),u.mc(26," Confirmar "),u.Ob(),u.Pb(27,"button",22),u.Wb("click",function(){return u.gc(t),u.Yb().recargarZonas(!0)}),u.mc(28," Volver "),u.Ob(),u.Ob(),u.Ob(),u.Ob(),u.Ob(),u.Ob()}if(2&t){const t=u.Yb();u.zb(4),u.oc("",t.crudAction," servicio"),u.zb(2),u.dc("formGroup",t.zonasForm),u.zb(4),u.dc("src",t.imageToShow,u.hc),u.zb(1),u.dc("hidden",!0),u.zb(3),u.dc("ngIf",t.creationImageError),u.zb(1),u.dc("ngIf",!t.acceptedFileTypes),u.zb(7),u.dc("ngIf",(null==t.zonasForm.controls.title.errors?null:t.zonasForm.controls.title.errors.required)&&t.zonasForm.controls.title.touched),u.zb(1),u.dc("ngIf",(null==t.zonasForm.controls.title.errors?null:t.zonasForm.controls.title.errors.minlength)&&t.zonasForm.controls.title.touched)}}const E=[{path:"",component:(()=>{class t{constructor(t,e,a){this.httpSrv=t,this.fb=e,this.adminPanelCrudService=a,this.someClass=!0,this.encabezadosTabla=["T\xedtulo"],this.tableData=[],this.zonas=[],this.isEditing=!1,this.isCreating=!1,this.crudAction="",this.imageToShow="../../../../../assets/no-image.png",this.acceptedFileTypes=!0,this.creationImageError="",this.destroy$=new o.a,this.createForm()}createForm(){this.zonasForm=this.fb.group({image:[""],title:["",[b.m.required,b.m.minLength(6)]]})}ngOnInit(){this.getZonas()}getZonas(){this.httpSrv.getAllZones().pipe(Object(r.a)(this.destroy$)).subscribe(t=>t.meta.status.toString().includes("20")?this.setTableData(t):Object(d.e)(t),t=>Object(d.d)(t))}setTableData(t){var e;null===(e=null==t?void 0:t.data)||void 0===e||e.forEach(t=>{this.tableData.push({imagen:`${l.a.API_IMAGE_URL}/${t.image}`,item2:t.title,id:t.id}),this.zonas.push(t)})}formSubmit(){var t;if(this.zonasForm.markAllAsTouched(),"Crear"!==this.crudAction||this.zonasForm.controls.image.value){if(this.zonasForm.valid){const e=new FormData;e.append("title",null===(t=this.zonasForm.controls.title)||void 0===t?void 0:t.value),this.fileToUpload&&e.append("image",this.fileToUpload),"Crear"===this.crudAction?this.crearZonaEnLaDb(e):this.editarZonaEnLaDb(e)}}else this.creationImageError="La im\xe1gen es obligatoria"}recargarZonas(t){t&&(this.resetsetControls(),this.tableData=[],this.tableData=[],this.zonas=[],this.isCreating=!1,this.isEditing=!1,this.getZonas())}resetsetControls(){var t,e,a,i;null===(e=null===(t=this.zonasForm.controls)||void 0===t?void 0:t.title)||void 0===e||e.setValue(""),null===(i=null===(a=this.zonasForm.controls)||void 0===a?void 0:a.image)||void 0===i||i.setValue(""),this.imageToShow="../../../../../assets/no-image.png"}showSelectedImage(t){var e;if("Crear"===this.crudAction&&!this.zonasForm.controls.image.value)return void(this.creationImageError="La im\xe1gen es obligatoria");this.creationImageError="";const a=null===(e=t.target)||void 0===e?void 0:e.files[0];if(this.acceptedFileTypes="image/jpg"===a.type||"image/jpeg"===a.type||"image/png"===a.type,a&&this.acceptedFileTypes){this.fileToUpload=a;const t=new FileReader;t.readAsDataURL(a),t.onload=()=>this.imageToShow=t.result}else this.imageToShow="../../../../../assets/no-image.png"}openCrearZona(){this.isEditing=!1,this.isCreating=!0,this.crudAction="Crear"}crearZonaEnLaDb(t){this.adminPanelCrudService.create(t,"categories").pipe(Object(r.a)(this.destroy$)).subscribe(t=>{this.recargarZonas(!0),Object(d.a)(t,"cre\xf3","zona")},t=>{this.recargarZonas(!0),Object(d.d)(t)})}openEditarZona(t){this.isEditing=!0,this.isCreating=!1,this.crudAction="Editar";const e=this.zonas.find(e=>e.id===t);e&&(this.zonaID=t,this.zonasForm.controls.title.setValue(e.title),this.imageToShow=`${l.a.API_IMAGE_URL}/${e.image}`)}editarZonaEnLaDb(t){this.adminPanelCrudService.edit(this.zonaID,t,"categories").pipe(Object(r.a)(this.destroy$)).subscribe(t=>{this.recargarZonas(!0),Object(d.a)(t,"edit\xf3","zona")},t=>{this.recargarZonas(!0),Object(d.d)(t)})}openBorrarZona(t){c.a.fire({title:"\xbfSeguro quer\xe9s elimninar la zona seleccionada?",showDenyButton:!0,confirmButtonText:"Si, borrar",denyButtonText:"No"}).then(e=>{e.isConfirmed&&this.borrarZonaEnLaDb(t)})}borrarZonaEnLaDb(t){this.adminPanelCrudService.delete(t,"categories").pipe(Object(r.a)(this.destroy$)).subscribe(t=>{this.recargarZonas(!0),Object(d.a)(t,"borr\xf3","zona")},t=>Object(d.d)(t))}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(u.Kb(m.a),u.Kb(b.c),u.Kb(h.a))},t.\u0275cmp=u.Eb({type:t,selectors:[["app-zonas"]],hostVars:2,hostBindings:function(t,e){2&t&&u.Cb("admin-panel-container",e.someClass)},decls:3,vars:2,consts:[[1,"row"],["class","col",4,"ngIf"],[1,"col"],[1,"card"],[1,"card-body"],[3,"title","filasTabla","encabezadosTabla","totalSection","onRecargar","onCreate","onEdit","onDelete",4,"ngIf"],[3,"title","filasTabla","encabezadosTabla","totalSection","onRecargar","onCreate","onEdit","onDelete"],[1,"card-header"],[1,"primary-dark"],[1,"form","p-t-20","form-material",3,"formGroup","ngSubmit"],[1,"row","justify-content-center"],[1,"col-md-4","mb-2",3,"click"],["alt","Trabajo realizado",1,"img-responsive",3,"src"],["type","file","formControlName","image",3,"hidden","change"],["imageInput",""],[1,"p-2"],["class","text-danger",4,"ngIf"],[1,"form-group"],[1,"input-group"],["type","text","id","exampleInputuname2","placeholder","T\xedtulo","formControlName","title",1,"form-control"],[1,"card-footer"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10","bgc-primary-dark"],["type","button",1,"btn","btn-danger","waves-effect","waves-light","m-r-10",3,"click"],[1,"text-danger"]],template:function(t,e){1&t&&(u.Pb(0,"div",0),u.kc(1,f,4,1,"div",1),u.kc(2,y,29,8,"div",1),u.Ob()),2&t&&(u.zb(1),u.dc("ngIf",!e.isEditing&&!e.isCreating),u.zb(1),u.dc("ngIf",e.isCreating||e.isEditing))},directives:[i.m,g.a,b.n,b.h,b.e,b.b,b.g,b.d],styles:[""]}),t})()}];let T=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.Ib({type:t}),t.\u0275inj=u.Hb({imports:[[n.f.forChild(E)],n.f]}),t})();var C=a("6eV/");let I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.Ib({type:t}),t.\u0275inj=u.Hb({imports:[[i.c,T,C.a,b.k]]}),t})()}}]);