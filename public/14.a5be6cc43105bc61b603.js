(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{cH24:function(e,t,a){"use strict";a.r(t),a.d(t,"UsersModule",function(){return T});var o=a("ofXK"),r=a("tyNb"),n=a("XNiG"),s=a("nYR2"),i=a("1G5W"),l=a("PSD3"),c=a.n(l),u=a("AytR"),d=a("fXoL"),b=a("3T3M"),m=a("T9Ob"),p=a("FQRV");function f(e,t){if(1&e){const e=d.Qb();d.Pb(0,"app-table",1),d.Wb("onRecargar",function(t){return d.gc(e),d.Yb().recargarUsuarios(t)})("onCreate",function(){return d.gc(e),d.Yb().crearUsuario()})("onEdit",function(t){return d.gc(e),d.Yb().changeRole(t)})("onDelete",function(t){return d.gc(e),d.Yb().borrarUSuario(t)}),d.Ob()}if(2&e){const e=d.Yb();d.dc("encabezadosTabla",e.encabezadosTabla)("filasTabla",e.tableData)("totalSection",null==e.users?null:e.users.length)("loading",e.loading)}}const h=[{path:"",component:(()=>{class e{constructor(e,t,a){this.usersService=e,this.router=t,this.adminPanelCrudService=a,this.someClass=!0,this.users=[],this.tableData=[],this.loading=!0,this.destroy$=new n.a}get encabezadosTabla(){return["Nombre","Email","Tel\xe9fono","Rol"]}ngOnInit(){this.loadUsers()}loadUsers(){this.loading=!0,this.usersService.getAllUsers().pipe(Object(s.a)(()=>this.loading=!1)).subscribe(e=>{this.setUsers(e),this.mapUsersForTable()})}setUsers(e){var t;this.users=null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.map(e=>({id:e.id,apellido:e.last_name,email:e.email,nombre:e.first_name,dni:e.dni,role:e.role,phone:e.phone,avatar:e.avatar,project:e.Projects,getAvatar:()=>{let t="";return t=e.avatar?`${u.a.API_IMAGE_URL}/users/${e.avatar}`:"assets/no-image.png",t}}))}mapUsersForTable(){this.tableData=this.users.map(e=>({imagen:e.getAvatar(),item2:`${e.nombre} ${e.apellido}`,item3:e.email?e.email:"Vac\xedo",item4:e.phone?e.phone:"Vac\xedo",item6:e.role?e.role:"Vac\xedo",id:e.id}))}recargarUsuarios(e){e&&(this.tableData=[],this.loadUsers())}crearUsuario(){this.router.navigateByUrl("/main/auth/register")}borrarUSuario(e){const t=this.users.find(t=>t.id===e);"master"!==(null==t?void 0:t.role)?c.a.fire({title:"\xbfEstas seguro?",text:`Estas a punto de borrar al usuario: ${null==t?void 0:t.nombre} ${null==t?void 0:t.apellido}`,icon:"question",showCancelButton:!0,confirmButtonText:"Si",cancelButtonText:"No"}).then(e=>{e.isConfirmed&&this.adminPanelCrudService.delete(null==t?void 0:t.id,"users").pipe(Object(i.a)(this.destroy$)).subscribe(()=>this.showConfirmationOfDelete(`${null==t?void 0:t.nombre} ${null==t?void 0:t.apellido}`),()=>c.a.fire("Error","Tuvimos un problema, por favor intent\xe1 nuevamente. Si el problema persiste ponete en contacto con tu proveedor de internet","error"))}):c.a.fire("Error",`\xa1${t.nombre}, no pod\xe9s borrarte a vos mismo CABALLO!`,"error")}showConfirmationOfDelete(e){c.a.fire({title:"Eliminado",text:`El usuario ${e} fue eliminado con \xe9xito`,icon:"success",confirmButtonText:"OK"}).then(e=>{e.isConfirmed&&this.loadUsers()})}changeRole(e){}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(d.Kb(b.a),d.Kb(r.c),d.Kb(m.a))},e.\u0275cmp=d.Eb({type:e,selectors:[["app-users"]],hostVars:2,hostBindings:function(e,t){2&e&&d.Cb("admin-panel-container",t.someClass)},decls:1,vars:1,consts:[["title","Usuarios",3,"encabezadosTabla","filasTabla","totalSection","loading","onRecargar","onCreate","onEdit","onDelete",4,"ngIf"],["title","Usuarios",3,"encabezadosTabla","filasTabla","totalSection","loading","onRecargar","onCreate","onEdit","onDelete"]],template:function(e,t){1&e&&d.kc(0,f,1,4,"app-table",0),2&e&&d.dc("ngIf",t.users&&t.tableData)},directives:[o.l,p.a],styles:[""]}),e})()}];let g=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({imports:[[r.f.forChild(h)],r.f]}),e})();var v=a("3Pt+"),U=a("6eV/");let T=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({imports:[[o.b,g,v.f,U.a]]}),e})()}}]);