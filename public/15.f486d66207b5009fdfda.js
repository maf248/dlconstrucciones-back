(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{gOo9:function(t,e,i){"use strict";i.r(e),i.d(e,"ServiciosContenidosModule",function(){return x});var n=i("ofXK"),o=i("tyNb"),r=i("XNiG"),s=i("1G5W"),c=i("3Pt+"),a=i("PSD3"),l=i.n(a),b=i("ZLyn"),d=i("fXoL"),u=i("N+K7"),v=i("T9Ob"),h=i("FQRV");function m(t,e){if(1&t){const t=d.Qb();d.Pb(0,"app-table",6),d.Wb("onRecargar",function(e){return d.gc(t),d.Yb(2).recargarServiceContents(e)})("onCreate",function(){return d.gc(t),d.Yb(2).crearContenido()})("onEdit",function(e){return d.gc(t),d.Yb(2).editarContenido(e)})("onDelete",function(e){return d.gc(t),d.Yb(2).borrarContenido(e)}),d.Ob()}if(2&t){const t=d.Yb(2);d.dc("title","Servicios/contenidos")("filasTabla",t.tableData)("encabezadosTabla",t.encabezadosTabla)("totalSection",null==t.tableData?null:t.tableData.length)("noImage",!0)}}function g(t,e){if(1&t&&(d.Pb(0,"div",2),d.Pb(1,"div",3),d.Pb(2,"div",4),d.kc(3,m,1,5,"app-table",5),d.Ob(),d.Ob(),d.Ob()),2&t){const t=d.Yb();d.zb(3),d.dc("ngIf",t.tableData)}}function C(t,e){if(1&t&&(d.Pb(0,"label"),d.mc(1),d.Ob()),2&t){const t=e.$implicit;d.zb(1),d.oc("Categor\xeda de servicio: ",t.title,"")}}function f(t,e){1&t&&(d.Pb(0,"span",20),d.mc(1,"Debe tener al menos 6 caracteres"),d.Ob())}function p(t,e){1&t&&(d.Pb(0,"span",20),d.mc(1,"Debe tener al menos 10 caracteres"),d.Ob())}function O(t,e){1&t&&(d.Pb(0,"span",20),d.mc(1,"Debes llenar al menos 1 de los dos campos"),d.Ob())}function S(t,e){if(1&t){const t=d.Qb();d.Pb(0,"div",2),d.Pb(1,"div",3),d.Pb(2,"div",7),d.Pb(3,"h1",8),d.mc(4),d.Ob(),d.Ob(),d.Pb(5,"div",4),d.Pb(6,"form",9),d.Wb("ngSubmit",function(){return d.gc(t),d.Yb().formSubmit()}),d.Pb(7,"div",4),d.Pb(8,"div",10),d.kc(9,C,2,1,"label",11),d.Ob(),d.Pb(10,"div",0),d.Pb(11,"div",2),d.Pb(12,"div",10),d.Pb(13,"div",12),d.Lb(14,"input",13),d.Pb(15,"div",14),d.kc(16,f,2,0,"span",15),d.Ob(),d.Ob(),d.Ob(),d.Pb(17,"div",10),d.Pb(18,"div",12),d.Lb(19,"textarea",16),d.Pb(20,"div",14),d.kc(21,p,2,0,"span",15),d.Ob(),d.Ob(),d.Ob(),d.Ob(),d.Ob(),d.Ob(),d.Pb(22,"div",17),d.Pb(23,"button",18),d.mc(24," Confirmar "),d.Ob(),d.Pb(25,"button",19),d.Wb("click",function(){return d.gc(t),d.Yb().recargarServiceContents(!0)}),d.mc(26," Volver "),d.Ob(),d.Ob(),d.Pb(27,"div",14),d.kc(28,O,2,0,"span",15),d.Ob(),d.Ob(),d.Ob(),d.Ob(),d.Ob()}if(2&t){const t=d.Yb();d.zb(4),d.oc("",t.crudAction," contenido de un servicio"),d.zb(2),d.dc("formGroup",t.serviceContentsForm),d.zb(3),d.dc("ngForOf",t.categoriaDeServicio),d.zb(7),d.dc("ngIf",(null==t.serviceContentsForm.controls.subtitle.errors?null:t.serviceContentsForm.controls.subtitle.errors.minlength)&&t.serviceContentsForm.controls.subtitle.touched),d.zb(5),d.dc("ngIf",(null==t.serviceContentsForm.controls.text.errors?null:t.serviceContentsForm.controls.text.errors.minlength)&&t.serviceContentsForm.controls.text.touched),d.zb(7),d.dc("ngIf",(null==t.serviceContentsForm.controls.text.errors?null:t.serviceContentsForm.controls.text.errors.required)&&t.serviceContentsForm.controls.text.touched)}}const P=[{path:"",component:(()=>{class t{constructor(t,e,i,n){this.httpSrv=t,this.adminPanelCrudService=e,this.fb=i,this.activatedRoute=n,this.someClass=!0,this.encabezadosTabla=["T\xedtulo","Descripci\xf3n"],this.tableData=[],this.isCreating=!1,this.isEditing=!1,this.crudAction="",this.categoriaDeServicio=[],this.contentCounter=0,this.contents=[],this.destroy$=new r.a,this.createForm()}createForm(){this.serviceContentsForm=this.fb.group({serviceId:[null,c.m.required],subtitle:["",c.m.minLength(6)],text:["",c.m.minLength(10)]},{validator:this.checkAtLeastOneTextFieldIsRequired})}checkAtLeastOneTextFieldIsRequired(t){const e=t.get("subtitle"),i=t.get("text");(null==e?void 0:e.value)||(null==i?void 0:i.value)||!(null==e?void 0:e.touched)&&!(null==i?void 0:i.touched)?null==i||i.setErrors(null):null==i||i.setErrors({required:!0})}ngOnInit(){this.getServicios()}formSubmit(){if(this.serviceContentsForm.markAllAsTouched(),this.serviceContentsForm.valid){const t=this.createFormData();t&&("Crear"===this.crudAction?this.crearContenidoEnLaDb(t):this.editarContenidoEnLaDb(t))}}createFormData(){let t={subtitle:void 0,text:void 0,serviceId:this.serviceContentsForm.controls.serviceId.value};return this.serviceContentsForm.controls.subtitle.value&&(t.subtitle=this.serviceContentsForm.controls.subtitle.value),this.serviceContentsForm.controls.text.value&&(t.text=this.serviceContentsForm.controls.text.value),t.subtitle?t.text||delete t.text:delete t.subtitle,t}getServicios(){this.httpSrv.getAllServices().pipe(Object(s.a)(this.destroy$)).subscribe(t=>{for(const e of t.data)this.categoriaDeServicio.push(e),this.httpSrv.getOneService(e.id.toString()).pipe(Object(s.a)(this.destroy$)).subscribe(e=>{e.meta.status.toString().includes("20")?this.setTableData(e,t.data.length):Object(b.e)(e)},t=>Object(b.d)(t))})}setTableData(t,e){this.activatedRoute.params.pipe(Object(s.a)(this.destroy$)).subscribe({next:i=>{var n,o,r;this.contentCounter++,this.categoriaDeServicio=this.categoriaDeServicio.filter(t=>t.id===+i.servicioId),null===(n=this.serviceContentsForm.controls.serviceId)||void 0===n||n.setValue(this.categoriaDeServicio[0].id),this.contents.length||(this.contents=null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.Contents.filter(t=>t.services_a_id===+i.servicioId)),this.contentCounter===e&&(null===(r=this.contents)||void 0===r||r.forEach(t=>{this.tableData.push({item2:t.subtitle?t.subtitle:"Vac\xedo",item3:t.text?t.text:"Vac\xedo",id:t.id})}))},error:t=>Object(b.d)(t)})}recargarServiceContents(t){t&&(this.resetsetControls(),this.tableData=[],this.contentCounter=0,this.categoriaDeServicio=[],this.contents=[],this.isCreating=!1,this.isEditing=!1,this.getServicios())}resetsetControls(){this.serviceContentsForm.controls.serviceId.setValue(""),this.serviceContentsForm.controls.subtitle.setValue(""),this.serviceContentsForm.controls.text.setValue("")}crearContenido(){this.crudAction="Crear",this.isCreating=!0,this.isEditing=!1}crearContenidoEnLaDb(t){this.adminPanelCrudService.createContentOrPictureInService(t,"contents").pipe(Object(s.a)(this.destroy$)).subscribe(t=>{this.recargarServiceContents(!0),Object(b.a)(t,"cre\xf3","contenido")},t=>{this.recargarServiceContents(!0),Object(b.d)(t)})}editarContenido(t){var e,i,n,o;this.crudAction="Editar",this.isEditing=!0,this.isCreating=!1;const r=null===(e=this.contents)||void 0===e?void 0:e.find(e=>e.id===t);r&&(this.contentId=r.id,null===(i=this.serviceContentsForm.controls.subtitle)||void 0===i||i.setValue(r.subtitle),null===(n=this.serviceContentsForm.controls.text)||void 0===n||n.setValue(r.text),null===(o=this.serviceContentsForm.controls.type)||void 0===o||o.setValue(r.services_a_id))}editarContenidoEnLaDb(t){this.adminPanelCrudService.editContentOrPictureInService(this.contentId,t,"contents").pipe(Object(s.a)(this.destroy$)).subscribe(t=>{this.recargarServiceContents(!0),Object(b.a)(t,"edit\xf3","contenido")},t=>{this.recargarServiceContents(!0),Object(b.d)(t)})}borrarContenido(t){l.a.fire({title:"\xbfSeguro quer\xe9s elimninar el trabajo realizado seleccionado?",showDenyButton:!0,confirmButtonText:"Si, borrar",denyButtonText:"No"}).then(e=>{e.isConfirmed&&this.borrarContenidoEnLaDb(t)})}borrarContenidoEnLaDb(t){this.adminPanelCrudService.deleteContentOrImageFromService(t,"contents").pipe(Object(s.a)(this.destroy$)).subscribe(t=>{this.recargarServiceContents(!0),Object(b.a)(t,"borr\xf3","contenido")},t=>Object(b.d)(t))}ngOnDestroy(){this.destroy$.next(),this.destroy$.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(d.Kb(u.a),d.Kb(v.a),d.Kb(c.c),d.Kb(o.a))},t.\u0275cmp=d.Eb({type:t,selectors:[["app-servicios-contenidos"]],hostVars:2,hostBindings:function(t,e){2&t&&d.Cb("admin-panel-container",e.someClass)},decls:3,vars:2,consts:[[1,"row"],["class","col",4,"ngIf"],[1,"col"],[1,"card"],[1,"card-body"],[3,"title","filasTabla","encabezadosTabla","totalSection","noImage","onRecargar","onCreate","onEdit","onDelete",4,"ngIf"],[3,"title","filasTabla","encabezadosTabla","totalSection","noImage","onRecargar","onCreate","onEdit","onDelete"],[1,"card-header"],[1,"primary-dark"],[1,"form","p-t-20","form-material",3,"formGroup","ngSubmit"],[1,"form-group"],[4,"ngFor","ngForOf"],[1,"input-group"],["type","text","placeholder","T\xedtulo","formControlName","subtitle",1,"form-control"],[1,"p-2"],["class","text-danger",4,"ngIf"],["type","text","id","exampleInputuname2","placeholder","Descripci\xf3n","formControlName","text","rows","5",1,"form-control"],[1,"card-footer"],["type","submit",1,"btn","btn-success","waves-effect","waves-light","m-r-10","bgc-primary-dark"],["type","button",1,"btn","btn-danger","waves-effect","waves-light","m-r-10",3,"click"],[1,"text-danger"]],template:function(t,e){1&t&&(d.Pb(0,"div",0),d.kc(1,g,4,1,"div",1),d.kc(2,S,29,6,"div",1),d.Ob()),2&t&&(d.zb(1),d.dc("ngIf",!e.isEditing&&!e.isCreating),d.zb(1),d.dc("ngIf",e.isCreating||e.isEditing))},directives:[n.m,h.a,c.n,c.h,c.e,n.l,c.b,c.g,c.d],styles:[""]}),t})()}];let F=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Ib({type:t}),t.\u0275inj=d.Hb({imports:[[o.f.forChild(P)],o.f]}),t})();var D=i("6eV/");let x=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Ib({type:t}),t.\u0275inj=d.Hb({imports:[[n.c,F,D.a,c.k]]}),t})()}}]);